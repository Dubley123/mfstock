# ==================== (零) 频率选择 ====================
selected_freqs:
  - monthly
  # - weekly

# ==================== (一) 数据路径配置 ====================
# (均以 project_root 的相对路径表示)
paths:
  data_dir: "data"        # 所有源数据文件存放的根目录
  output_dir: "output"    # 模型训练和预测结果输出目录

# ==================== (二) 数据集配置 ====================
dataset:
  # 特征文件路径（相对于 data_dir）
  feature_files:
    monthly: "feature/feature_monthly.parquet"
    weekly: "feature/feature_weekly.parquet"
  
  # 目标文件路径（相对于 data_dir）
  target_files:
    monthly: "target/target_monthly.parquet"
    weekly: "target/target_weekly.parquet"

  # 时间和股票列名
  time_col: "TradingDate"
  stkcd_col: "Stkcd"
  
  # 特征预处理器配置
  processor:
    nan_handler: "median"     # NaN处理方式
    outlier_handler: "mad"    # 异常值处理
    norm_handler: "zscore"    # 归一化方式

# ==================== (三) 滚动窗口配置 ====================
rolling_window:
  # 各频率的 lookback 窗口长度
  lookback_windows:
    monthly: "12m"      # 12个月
    weekly: "4w"        # 8周
    
  train_window: "5y"    # 训练集窗口长度
  val_window: "2y"      # 验证集窗口长度
  test_window: "3m"     # 测试集窗口长度
  test_start_time: "2020"  # 测试集起始时间
  rebalance_freq: "1m"  # 调仓频率

  batch_size: 1024
  shuffle_train: false   # 训练集是否打乱
  num_workers: 0        # 数据加载线程数（Windows建议设为0）

# ==================== (四) 模型配置 ====================
model:
  global:
    dropout: 0.1
    fusion_method: "concat"  # 各频率向量拼接方法: 'concat'/'weighted'
    use_ae: true             # 是否启用 AutoEncoder 重构辅助任务
    ae_alpha: 0.1            # 重构损失的权重系数
  
  # 各频率模型的特定配置
  freq_specific:
    monthly:
      d_model: 128    # Embedding维度
      nhead: 4        # 注意力头数
      num_layers: 2   # Transformer层数
    weekly:
      d_model: 128
      nhead: 4
      num_layers: 2

# ==================== (六) 训练配置 ====================
training:
  # 优化器配置
  learning_rate: 1.0e-4
  weight_decay: 0.01
  
  # 训练轮数
  base_epochs: 100       # 第一个窗口（Base Window）从随机初始化开始的轮数
  rolling_epochs: 10     # 滚动过程中，加载上一期权重后的增量更新轮数
  refine_epochs: 0      # 针对所有已经训练好的模型，统一进行的后期性能强化轮数
  
  # 早停配置
  patience: 15          # 早停耐心值
  
  # 是否详细输出
  verbose: true

# ==================== (七) 设备配置 ====================
runtime:
  device: "cuda"  # 'cuda' 或 'cpu'
  seed: 42  # 随机种子
